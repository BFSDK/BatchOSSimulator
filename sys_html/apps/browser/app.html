<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #1e1e1e;
            color: #e0e0e0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header Styles */
        .header {
            background-color: #2d2d30;
            padding: 10px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #3e3e42;
        }

        .nav-buttons {
            display: flex;
            gap: 5px;
        }

        .nav-button {
            background-color: #3e3e42;
            border: none;
            color: #e0e0e0;
            width: 30px;
            height: 30px;
            border-radius: 3px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-button:hover {
            background-color: #4a4a4f;
        }

        .address-bar {
            flex: 1;
            margin: 0 10px;
            display: flex;
        }

        .address-input {
            width: 100%;
            padding: 8px 15px;
            background-color: #3e3e42;
            border: 1px solid #4a4a4f;
            border-radius: 20px;
            color: #e0e0e0;
            outline: none;
        }

        .address-input:focus {
            border-color: #4fc3f7;
        }

        .bookmark-button {
            background-color: #3e3e42;
            border: none;
            color: #e0e0e0;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            margin-left: 5px;
        }

        .bookmark-button:hover {
            background-color: #4a4a4f;
        }

        .toggle-bookmarks {
            background-color: #3e3e42;
            border: none;
            color: #e0e0e0;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            margin-left: 5px;
        }

        .toggle-bookmarks:hover {
            background-color: #4a4a4f;
        }

        /* Tabs Styles */
        .tabs-container {
            background-color: #252526;
            display: flex;
            padding: 5px 10px 0;
            overflow-x: auto;
            border-bottom: 1px solid #3e3e42;
        }

        .tab {
            background-color: #2d2d30;
            padding: 8px 15px;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            max-width: 200px;
            min-width: 150px;
        }

        .tab.active {
            background-color: #1e1e1e;
            border-bottom: 2px solid #4fc3f7;
        }

        .tab-title {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .tab-close {
            margin-left: 8px;
            color: #888;
            font-size: 16px;
        }

        .tab-close:hover {
            color: #e0e0e0;
        }

        .new-tab {
            background-color: transparent;
            border: none;
            color: #888;
            font-size: 20px;
            width: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .new-tab:hover {
            color: #e0e0e0;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            display: flex;
        }

        .bookmarks-panel {
            width: 250px;
            background-color: #252526;
            border-right: 1px solid #3e3e42;
            padding: 15px;
            overflow-y: auto;
            transition: width 0.3s ease;
        }

        .bookmarks-panel.hidden {
            width: 0;
            padding: 0;
            overflow: hidden;
        }

        .bookmarks-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .bookmarks-title {
            font-size: 16px;
            font-weight: bold;
        }

        .add-bookmark {
            background-color: #3e3e42;
            border: none;
            color: #e0e0e0;
            width: 25px;
            height: 25px;
            border-radius: 3px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .bookmark-item {
            padding: 8px;
            margin-bottom: 5px;
            background-color: #2d2d30;
            border-radius: 3px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .bookmark-item:hover {
            background-color: #3e3e42;
        }

        .bookmark-delete {
            color: #888;
            font-size: 14px;
        }

        .bookmark-delete:hover {
            color: #ff5252;
        }

        .browser-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            transition: margin-left 0.3s ease;
        }

        .browser-content.full-width {
            margin-left: 0;
        }

        .iframe-container {
            flex: 1;
            position: relative;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
            background-color: white;
        }

        .start-page {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #1e1e1e;
            color: #888;
            padding: 20px;
            text-align: center;
        }

        .start-page h1 {
            font-size: 32px;
            margin-bottom: 20px;
            color: #4fc3f7;
        }

        .start-page p {
            margin-bottom: 30px;
            max-width: 500px;
            text-align: center;
            line-height: 1.5;
        }

        .warning {
            background-color: #ff9800;
            color: #1e1e1e;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            max-width: 600px;
            font-weight: bold;
        }

        .search-box {
            width: 80%;
            max-width: 600px;
            display: flex;
        }

        .search-input {
            flex: 1;
            padding: 12px 20px;
            background-color: #3e3e42;
            border: 1px solid #4a4a4f;
            border-radius: 24px 0 0 24px;
            color: #e0e0e0;
            outline: none;
        }

        .search-button {
            padding: 12px 25px;
            background-color: #4fc3f7;
            border: none;
            border-radius: 0 24px 24px 0;
            color: #1e1e1e;
            font-weight: bold;
            cursor: pointer;
        }

        .search-button:hover {
            background-color: #29b6f6;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: #2d2d30;
            padding: 20px;
            border-radius: 5px;
            width: 400px;
            max-width: 90%;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: bold;
        }

        .modal-close {
            background: none;
            border: none;
            color: #888;
            font-size: 20px;
            cursor: pointer;
        }

        .modal-close:hover {
            color: #e0e0e0;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 8px 10px;
            background-color: #3e3e42;
            border: 1px solid #4a4a4f;
            border-radius: 3px;
            color: #e0e0e0;
            outline: none;
        }

        .form-input:focus {
            border-color: #4fc3f7;
        }

        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-primary {
            background-color: #4fc3f7;
            color: #1e1e1e;
        }

        .btn-secondary {
            background-color: #3e3e42;
            color: #e0e0e0;
        }

        /* Scrollbar Styles */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #2d2d30;
        }

        ::-webkit-scrollbar-thumb {
            background: #4a4a4f;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #5a5a5f;
        }
    </style>
</head>
<body>
    <!-- Header with navigation controls -->
    <div class="header">
        <div class="nav-buttons">
            <button class="nav-button" id="refresh-button">↻</button>
        </div>
        <div class="address-bar">
            <input type="text" class="address-input" id="address-input" placeholder="Search or enter website address">
        </div>
        <button class="bookmark-button" id="bookmark-current">Bookmark</button>
        <button class="toggle-bookmarks" id="toggle-bookmarks">Hide Bookmarks</button>
    </div>

    <!-- Tabs container -->
    <div class="tabs-container" id="tabs-container">
        <!-- Tabs will be dynamically added here -->
        <button class="new-tab" id="new-tab-button">+</button>
    </div>

    <!-- Content area with bookmarks panel and browser content -->
    <div class="content-area">
        <div class="bookmarks-panel" id="bookmarks-panel">
            <div class="bookmarks-header">
                <div class="bookmarks-title">Bookmarks</div>
                <button class="add-bookmark" id="add-bookmark-button">+</button>
            </div>
            <div class="bookmarks-list" id="bookmarks-list">
                <!-- Bookmarks will be dynamically added here -->
            </div>
        </div>
        <div class="browser-content" id="browser-content">
            <div class="iframe-container" id="iframe-container">
                <!-- Start page when no tab is active -->
                <div class="start-page" id="start-page">
                    <h1>Welcome</h1>
                    <div class="warning">
                        Some websites may not display correctly due to their iframe policies.
                    </div>
                    <p>Start browsing by entering a URL or search term above.</p>
                    <div class="search-box">
                        <input type="text" class="search-input" id="search-input" placeholder="Search the web...">
                        <button class="search-button" id="search-button">Search</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for adding bookmarks -->
    <div class="modal" id="bookmark-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Add Bookmark</div>
                <button class="modal-close" id="close-bookmark-modal">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label" for="bookmark-name">Name</label>
                <input type="text" class="form-input" id="bookmark-name" placeholder="Enter bookmark name">
            </div>
            <div class="form-group">
                <label class="form-label" for="bookmark-url">URL</label>
                <input type="text" class="form-input" id="bookmark-url" placeholder="https://example.com">
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" id="cancel-bookmark">Cancel</button>
                <button class="btn btn-primary" id="save-bookmark">Save</button>
            </div>
        </div>
    </div>

    <script>
        // Browser state
        const browserState = {
            tabs: [],
            activeTab: null,
            bookmarks: [],
            bookmarksVisible: true
        };

        // DOM Elements
        const tabsContainer = document.getElementById('tabs-container');
        const iframeContainer = document.getElementById('iframe-container');
        const startPage = document.getElementById('start-page');
        const addressInput = document.getElementById('address-input');
        const refreshButton = document.getElementById('refresh-button');
        const newTabButton = document.getElementById('new-tab-button');
        const bookmarkCurrentButton = document.getElementById('bookmark-current');
        const bookmarksList = document.getElementById('bookmarks-list');
        const addBookmarkButton = document.getElementById('add-bookmark-button');
        const bookmarkModal = document.getElementById('bookmark-modal');
        const closeBookmarkModal = document.getElementById('close-bookmark-modal');
        const cancelBookmark = document.getElementById('cancel-bookmark');
        const saveBookmark = document.getElementById('save-bookmark');
        const bookmarkName = document.getElementById('bookmark-name');
        const bookmarkUrl = document.getElementById('bookmark-url');
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        const toggleBookmarksButton = document.getElementById('toggle-bookmarks');
        const bookmarksPanel = document.getElementById('bookmarks-panel');
        const browserContent = document.getElementById('browser-content');

        // Initialize browser
        function initBrowser() {
            // Load bookmarks from localStorage
            const savedBookmarks = localStorage.getItem('browserBookmarks');
            if (savedBookmarks) {
                browserState.bookmarks = JSON.parse(savedBookmarks);
                renderBookmarks();
            }

            // Create initial tab
            createNewTab();
            
            // Set up event listeners
            setupEventListeners();
        }

        // Set up all event listeners
        function setupEventListeners() {
            // Navigation buttons
            refreshButton.addEventListener('click', refreshPage);
            
            // Tab management
            newTabButton.addEventListener('click', createNewTab);
            
            // Address bar
            addressInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    navigateToAddress();
                }
            });
            
            // Bookmark management
            bookmarkCurrentButton.addEventListener('click', bookmarkCurrentPage);
            addBookmarkButton.addEventListener('click', openBookmarkModal);
            closeBookmarkModal.addEventListener('click', closeModal);
            cancelBookmark.addEventListener('click', closeModal);
            saveBookmark.addEventListener('click', saveNewBookmark);
            
            // Search functionality
            searchButton.addEventListener('click', performSearch);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
            
            // Toggle bookmarks panel
            toggleBookmarksButton.addEventListener('click', toggleBookmarksPanel);
        }

        // Toggle bookmarks panel visibility
        function toggleBookmarksPanel() {
            browserState.bookmarksVisible = !browserState.bookmarksVisible;
            
            if (browserState.bookmarksVisible) {
                bookmarksPanel.classList.remove('hidden');
                browserContent.classList.remove('full-width');
                toggleBookmarksButton.textContent = 'Hide Bookmarks';
            } else {
                bookmarksPanel.classList.add('hidden');
                browserContent.classList.add('full-width');
                toggleBookmarksButton.textContent = 'Show Bookmarks';
            }
        }

        // Tab management functions
        function createNewTab(url = null) {
            const tabId = 'tab-' + Date.now();
            const tab = {
                id: tabId,
                title: 'New Tab',
                url: url || '',
                history: [],
                historyIndex: -1
            };
            
            browserState.tabs.push(tab);
            browserState.activeTab = tab;
            
            renderTabs();
            updateBrowserContent();
            
            return tab;
        }

        function switchTab(tabId) {
            browserState.activeTab = browserState.tabs.find(tab => tab.id === tabId);
            renderTabs();
            updateBrowserContent();
        }

        function closeTab(tabId, event) {
            event.stopPropagation();
            
            const tabIndex = browserState.tabs.findIndex(tab => tab.id === tabId);
            if (tabIndex === -1) return;
            
            browserState.tabs.splice(tabIndex, 1);
            
            if (browserState.activeTab && browserState.activeTab.id === tabId) {
                if (browserState.tabs.length > 0) {
                    // Switch to the next tab or the previous one
                    const newActiveIndex = Math.min(tabIndex, browserState.tabs.length - 1);
                    browserState.activeTab = browserState.tabs[newActiveIndex];
                } else {
                    browserState.activeTab = null;
                }
            }
            
            renderTabs();
            updateBrowserContent();
        }

        function renderTabs() {
            // Clear existing tabs (except the new tab button)
            const existingTabs = Array.from(tabsContainer.querySelectorAll('.tab'));
            existingTabs.forEach(tab => tab.remove());
            
            // Render each tab
            browserState.tabs.forEach(tab => {
                const tabElement = document.createElement('div');
                tabElement.className = `tab ${tab.id === browserState.activeTab?.id ? 'active' : ''}`;
                tabElement.setAttribute('data-tab-id', tab.id);
                
                tabElement.innerHTML = `
                    <div class="tab-title">${tab.title}</div>
                    <div class="tab-close" data-tab-id="${tab.id}">×</div>
                `;
                
                tabElement.addEventListener('click', () => switchTab(tab.id));
                
                const closeButton = tabElement.querySelector('.tab-close');
                closeButton.addEventListener('click', (e) => closeTab(tab.id, e));
                
                tabsContainer.insertBefore(tabElement, newTabButton);
            });
        }

        // Browser content management
        function updateBrowserContent() {
            // Clear iframe container
            iframeContainer.innerHTML = '';
            
            if (!browserState.activeTab) {
                // Show start page if no active tab
                iframeContainer.appendChild(startPage);
                addressInput.value = '';
                return;
            }
            
            const activeTab = browserState.activeTab;
            addressInput.value = activeTab.url || '';
            
            if (activeTab.url) {
                // Create iframe for the URL
                const iframe = document.createElement('iframe');
                iframe.src = activeTab.url;
                iframeContainer.appendChild(iframe);
                
                // Hide start page
                startPage.style.display = 'none';
                
                // Update tab title when iframe loads
                iframe.addEventListener('load', () => {
                    try {
                        activeTab.title = iframe.contentDocument.title || activeTab.url;
                        renderTabs();
                    } catch (e) {
                        // Cross-origin restrictions may prevent accessing iframe content
                        activeTab.title = activeTab.url;
                        renderTabs();
                    }
                });
            } else {
                // Show start page for empty tabs
                iframeContainer.appendChild(startPage);
                startPage.style.display = 'flex';
            }
        }

        // Navigation functions
        function navigateToAddress() {
            const url = addressInput.value.trim();
            if (!url) return;
            
            let fullUrl = url;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                // If it doesn't look like a URL, treat it as a search
                if (url.includes('.') && !url.includes(' ')) {
                    fullUrl = 'https://' + url;
                } else {
                    fullUrl = 'https://www.google.com/search?q=' + encodeURIComponent(url);
                }
            }
            
            if (browserState.activeTab) {
                browserState.activeTab.url = fullUrl;
                updateBrowserContent();
            } else {
                createNewTab(fullUrl);
            }
        }

        function refreshPage() {
            if (browserState.activeTab && browserState.activeTab.url) {
                updateBrowserContent();
            }
        }

        // Bookmark management
        function bookmarkCurrentPage() {
            if (browserState.activeTab && browserState.activeTab.url) {
                bookmarkName.value = browserState.activeTab.title;
                bookmarkUrl.value = browserState.activeTab.url;
                openBookmarkModal();
            } else {
                alert('No page to bookmark');
            }
        }

        function openBookmarkModal() {
            bookmarkModal.style.display = 'flex';
        }

        function closeModal() {
            bookmarkModal.style.display = 'none';
            bookmarkName.value = '';
            bookmarkUrl.value = '';
        }

        function saveNewBookmark() {
            const name = bookmarkName.value.trim();
            const url = bookmarkUrl.value.trim();
            
            if (!name || !url) {
                alert('Please enter both name and URL');
                return;
            }
            
            // Validate URL format
            let fullUrl = url;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                fullUrl = 'https://' + url;
            }
            
            // Add the bookmark
            browserState.bookmarks.push({
                id: 'bookmark-' + Date.now(),
                name: name,
                url: fullUrl
            });
            
            // Save to localStorage
            localStorage.setItem('browserBookmarks', JSON.stringify(browserState.bookmarks));
            
            // Update UI
            renderBookmarks();
            closeModal();
        }

        function renderBookmarks() {
            bookmarksList.innerHTML = '';
            
            browserState.bookmarks.forEach(bookmark => {
                const bookmarkElement = document.createElement('div');
                bookmarkElement.className = 'bookmark-item';
                bookmarkElement.setAttribute('data-bookmark-id', bookmark.id);
                
                bookmarkElement.innerHTML = `
                    <div class="bookmark-name">${bookmark.name}</div>
                    <div class="bookmark-delete" data-bookmark-id="${bookmark.id}">×</div>
                `;
                
                bookmarkElement.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('bookmark-delete')) {
                        // Open bookmark in a new tab
                        createNewTab(bookmark.url);
                    }
                });
                
                const deleteButton = bookmarkElement.querySelector('.bookmark-delete');
                deleteButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    deleteBookmark(bookmark.id);
                });
                
                bookmarksList.appendChild(bookmarkElement);
            });
        }

        function deleteBookmark(bookmarkId) {
            browserState.bookmarks = browserState.bookmarks.filter(bookmark => bookmark.id !== bookmarkId);
            localStorage.setItem('browserBookmarks', JSON.stringify(browserState.bookmarks));
            renderBookmarks();
        }

        // Search functionality
        function performSearch() {
            const query = searchInput.value.trim();
            if (!query) return;
            
            const searchUrl = 'https://www.google.com/search?q=' + encodeURIComponent(query);
            
            if (browserState.activeTab) {
                browserState.activeTab.url = searchUrl;
                updateBrowserContent();
            } else {
                createNewTab(searchUrl);
            }
            
            searchInput.value = '';
        }

        // Initialize the browser when the page loads
        document.addEventListener('DOMContentLoaded', initBrowser);
    </script>
</body>
</html>