<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Store</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #222;
            color: #fff;
            height: 100vh;
            overflow: hidden;
        }

        .store-container {
            display: flex;
            height: 100%;
            background: #222;
        }

        /* –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ */
        .sidebar {
            width: 150px;
            background: #2a2a2a;
            border-right: 1px solid #444;
            padding: 10px 0;
            flex-shrink: 0;
        }

        .tab-item {
            padding: 12px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
            border-left: 3px solid transparent;
            text-align: left;
        }

        .tab-item:hover {
            background: #333;
        }

        .tab-item.active {
            background: #333;
            border-left-color: #0078d4;
        }

        /* –û–±–ª–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #222;
            min-height: 0; /* –í–∞–∂–Ω–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞ */
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        .content-header {
            background: #333;
            padding: 15px 20px;
            border-bottom: 1px solid #444;
            flex-shrink: 0;
        }

        .content-title {
            font-size: 18px;
            font-weight: bold;
        }

        /* –°–µ—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π */
        .apps-grid {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            min-height: 0; /* –í–∞–∂–Ω–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞ */
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
        .app-card {
            background: #333;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid #444;
            text-align: left;
        }

        .app-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border-color: #0078d4;
        }

        .app-name {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .app-description {
            font-size: 13px;
            color: #999;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .app-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .app-price {
            font-weight: bold;
            color: #4ec9b0;
            font-size: 14px;
        }

        .app-developer {
            color: #888;
            font-size: 12px;
        }

        .app-button {
            width: 100%;
            padding: 8px;
            background: #0078d4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 13px;
        }

        .app-button:hover {
            background: #106ebe;
        }

        .app-button.installed {
            background: #107c10;
        }

        .app-button.installed:hover {
            background: #0d6b0d;
        }

        /* –°—Ç—Ä–∞–Ω–∏—Ü–∞ Custom Apps */
        .custom-apps-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            min-height: 0; /* –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞ */
        }

        .custom-apps-inner {
            max-width: 600px;
            margin: 0 auto;
        }

        .custom-apps-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #fff;
        }

        .custom-apps-description {
            line-height: 1.6;
            margin-bottom: 30px;
            color: #ccc;
        }

        .instructions {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #444;
            margin-bottom: 30px;
        }

        .instructions ol {
            padding-left: 20px;
            margin-bottom: 0;
        }

        .instructions li {
            margin-bottom: 10px;
            color: #ccc;
        }

        .instructions li:last-child {
            margin-bottom: 0;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #fff;
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #555;
            border-radius: 4px;
            font-size: 14px;
            background: #1a1a1a;
            color: #fff;
            transition: border-color 0.2s;
        }

        .form-control:focus {
            border-color: #0078d4;
            outline: none;
        }

        .install-button {
            width: 100%;
            padding: 12px;
            background: #0078d4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.2s;
            margin-bottom: 30px;
        }

        .install-button:hover {
            background: #106ebe;
        }

        .install-button:disabled {
            background: #555;
            cursor: not-allowed;
        }

        .tips-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #444;
        }

        .tips-title {
            color: #888;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .tips-list {
            color: #888;
            font-size: 13px;
            padding-left: 20px;
        }

        .tips-list li {
            margin-bottom: 8px;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #333;
            border: 1px solid #555;
            border-radius: 6px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 3000;
            display: none;
            max-width: 400px;
        }

        .notification.success {
            border-left: 4px solid #107c10;
        }

        .notification.error {
            border-left: 4px solid #d83b01;
        }

        /* –°–∫—Ä–æ–ª–ª–±–∞—Ä */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #333;
        }

        ::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #666;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-height: 600px) {
            .custom-apps-content {
                padding: 15px;
            }
            
            .custom-apps-title {
                font-size: 20px;
                margin-bottom: 15px;
            }
            
            .instructions {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            .form-group {
                margin-bottom: 15px;
            }
        }
        /* DONT DELETE!!! Styles for cursor! */
        * {
            cursor: none !important;
        }

        .custom-cursor {
            position: fixed;
            top: 0;
            left: 0;
            width: 32px;
            height: 32px;
            pointer-events: none;
            z-index: 9999;
            background-image: url('../../bin/cur/cursor.png'); /* path to system cursor, you can make path to your cursor */
            background-size: cover;
        }
        /* End of styles for cursors */
    </style>
</head>
<body>
    <div class="custom-cursor"></div>
    <div class="store-container">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –≤–∫–ª–∞–¥–∫–∞–º–∏ -->
        <div class="sidebar">
            <div class="tab-item active" onclick="showTab('apps')">Apps</div>
            <div class="tab-item" onclick="showTab('installed')">Installed</div>
            <div class="tab-item" onclick="showTab('custom')">Custom Apps</div>
        </div>

        <!-- –û–±–ª–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
        <div class="content-area">
            <div class="content-header">
                <div class="content-title" id="contentTitle">Available Apps</div>
            </div>
            
            <!-- –°–µ—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π -->
            <div class="apps-grid" id="appsGrid">
                <!-- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ Custom Apps -->
            <div class="custom-apps-content" id="customAppsContent" style="display: none;">
                <div class="custom-apps-inner">
                    <div class="custom-apps-title">Install Custom App</div>
                    <div class="custom-apps-description">
                        Install your own custom applications to BatchOS. Make sure you have prepared the application folder before proceeding.
                    </div>
                    
                    <div class="instructions">
                        <ol>
                            <li>You must have a folder with your application.</li>
                            <li>Copy this folder to the root partition of the system, to the apps folder.</li>
                            <li>Below, you can see the input fields: in the id field, enter the name of the application folder (preferably with all letters in lowercase), in the icon field, enter the symbol that will be displayed in the system, and in the Name field, enter the display name of the program.</li>
                            <li>After entering the necessary information, click on the install button. The program should appear in XFinder.</li>
                        </ol>
                    </div>

                    <div class="form-group">
                        <label for="customAppId">Application ID (folder name):</label>
                        <input type="text" id="customAppId" class="form-control" placeholder="e.g., myapp" oninput="validateForm()">
                        <div style="font-size: 12px; color: #888; margin-top: 5px;">Must match your app folder name in /apps/ directory</div>
                    </div>

                    <div class="form-group">
                        <label for="customAppName">Display Name:</label>
                        <input type="text" id="customAppName" class="form-control" placeholder="e.g., My Awesome App" oninput="validateForm()">
                    </div>

                    <div class="form-group">
                        <label for="customAppIcon">Icon Symbol:</label>
                        <input type="text" id="customAppIcon" class="form-control" placeholder="e.g., ‚ö°" oninput="validateForm()">
                        <div style="font-size: 12px; color: #888; margin-top: 5px;">Single emoji or symbol to represent your app</div>
                    </div>

                    <button class="install-button" id="installButton" onclick="installCustomApp()" disabled>
                        Install Custom App
                    </button>

                    <div class="tips-section">
                        <div class="tips-title">Tips:</div>
                        <ul class="tips-list">
                            <li>Your app folder should contain an app.html file</li>
                            <li>Use lowercase letters for the application ID</li>
                            <li>Test your app thoroughly before installation</li>
                            <li>Custom apps will appear in the XFinder menu</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="notification" id="notification">
        <div id="notificationText">Notification message</div>
    </div>

    <script>

        function notify(title, subtitle) {
            window.parent.postMessage({
                type: 'BATCHOS_API',
                action: 'SHOW_NOTIFY',
                data: {
                    notif_title: title,
                    notif_subtitle: subtitle
                }
            }, '*');
        }
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentTab = 'apps';
        let installedApps = [];
        let availableApps = [];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadInstalledApps();
            loadAvailableApps();
            showTab('apps');
        });

        function loadInstalledApps() {
            try {
                const saved = localStorage.getItem('batchos_installed_apps');
                installedApps = saved ? JSON.parse(saved) : [];
            } catch (e) {
                installedApps = [];
            }
        }

        function loadAvailableApps() {
            availableApps = [
                {
                    id: 'snake',
                    icon: 'üêç',
                    name: 'Snake Game',
                    description: 'Classic snake game with multiple difficulty levels. Control the snake, eat food, and grow longer without hitting the walls or yourself.',
                    developer: 'BatchOS',
                    category: 'games',
                    price: 'FREE',
                    version: '1.0.0',
                    size: '0.8 MB'
                },
                {
                    id: 'webint',
                    icon: 'üñâ',
                    name: 'Webint - drawing app',
                    description: 'Simple drawing app for batchos.',
                    developer: 'Batch_395', 
                    category: 'utilities',
                    price: 'FREE',
                    version: '1.0.0',
                    size: '2.1 MB'
                },
                {
                    id: 'synapse',
                    icon: '¬ß',
                    name: 'Synapse.AI',
                    description: 'Work with pwide and synsearch in batchos! The official synapse app for websystem.',
                    developer: 'Syanpse AI Tech.', 
                    category: 'ai',
                    price: 'FREE',
                    version: '1.0.0',
                    size: '2.9 MB'
                },
                {
                    id: 'codeeditor',
                    icon: 'MS',
                    name: 'Monospace Code Editor',
                    description: 'The base code editor for BatchOS. Can run html and you can write text, python and more languages code.',
                    developer: 'cout << "CODE_PRODUCTS" << endl;', 
                    category: 'development',
                    price: 'FREE',
                    version: '1.0.0',
                    size: '0.7 MB'
                },
                {
                    id: 'mines',
                    icon: 'üö©',
                    name: 'Mines',
                    description: 'The classic minesweeper game for BatchOS.',
                    developer: 'BatchOS', 
                    category: 'games',
                    price: 'FREE',
                    version: '1.0.0',
                    size: '0.7 MB'
                },
                {
                    id: 'test_notify',
                    icon: 'TS',
                    name: 'NST',
                    description: 'Notification test system',
                    developer: 'BatchOS', 
                    category: 'utilites',
                    price: 'FREE',
                    version: '1.0.0',
                    size: '0.7 MB'
                }
            ];
        }

        
        function showTab(tab) {
            currentTab = tab;
            
            
            document.querySelectorAll('.tab-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            
            const title = document.getElementById('contentTitle');
            const appsGrid = document.getElementById('appsGrid');
            const customAppsContent = document.getElementById('customAppsContent');
            
            switch(tab) {
                case 'apps':
                    title.textContent = 'Available Apps';
                    appsGrid.style.display = 'grid';
                    customAppsContent.style.display = 'none';
                    renderApps('available');
                    break;
                case 'installed':
                    title.textContent = 'Installed Apps';
                    appsGrid.style.display = 'grid';
                    customAppsContent.style.display = 'none';
                    renderApps('installed');
                    break;
                case 'custom':
                    title.textContent = 'Custom Apps';
                    appsGrid.style.display = 'none';
                    customAppsContent.style.display = 'block';
                    break;
            }
        }

        function renderApps(type = 'available') {
            const appsGrid = document.getElementById('appsGrid');
            
            let appsToShow = [];
            
            if (type === 'available') {
                appsToShow = availableApps;
            } else if (type === 'installed') {
                appsToShow = availableApps.filter(app => installedApps.includes(app.id));
            }
            
            appsGrid.innerHTML = '';
            
            if (appsToShow.length === 0) {
                if (type === 'installed') {
                    appsGrid.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px; color: #666;">
                            <div style="font-size: 18px; margin-bottom: 10px;">No apps installed</div>
                            <div style="font-size: 14px;">Visit the "Apps" tab to browse available applications</div>
                        </div>
                    `;
                } else {
                    appsGrid.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px; color: #666;">
                            <div style="font-size: 18px; margin-bottom: 10px;">No apps available</div>
                            <div style="font-size: 14px;">More applications coming soon!</div>
                        </div>
                    `;
                }
                return;
            }
            
            appsToShow.forEach(app => {
                const isInstalled = installedApps.includes(app.id);
                const appCard = document.createElement('div');
                appCard.className = 'app-card';
                
                appCard.innerHTML = `
                    <div class="app-name">${app.name}</div>
                    <div class="app-description">${app.description}</div>
                    <div class="app-meta">
                        <div class="app-price">${app.price}</div>
                        <div class="app-developer">by ${app.developer}</div>
                    </div>
                    <button class="app-button ${isInstalled ? 'installed' : ''}" 
                            onclick="${isInstalled ? 'uninstallApp' : 'installApp'}('${app.id}')">
                        ${isInstalled ? 'Uninstall' : 'Install'}
                    </button>
                `;
                
                appsGrid.appendChild(appCard);
            });
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function validateForm() {
            const appId = document.getElementById('customAppId').value.trim();
            const appName = document.getElementById('customAppName').value.trim();
            const appIcon = document.getElementById('customAppIcon').value.trim();
            const installButton = document.getElementById('installButton');
            
            const isValid = appId.length > 0 && appName.length > 0 && appIcon.length > 0;
            installButton.disabled = !isValid;
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function installCustomApp() {
            const appId = document.getElementById('customAppId').value.trim().toLowerCase();
            const appName = document.getElementById('customAppName').value.trim();
            const appIcon = document.getElementById('customAppIcon').value.trim();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ª–∏ —É–∂–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ç–∞–∫–∏–º ID
            if (installedApps.includes(appId)) {
                showNotification(`App with ID "${appId}" is already installed!`, 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —Ç–∞–∫–æ–≥–æ ID –≤ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
            const existingApp = availableApps.find(app => app.id === appId);
            if (existingApp) {
                showNotification(`App with ID "${appId}" already exists in the store!`, 'error');
                return;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            installedApps.push(appId);
            saveInstalledApps();
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –æ—Å–Ω–æ–≤–Ω—É—é –û–° –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            window.parent.postMessage({
                type: 'BATCHOS_API',
                action: 'BATCHOS_APP_INSTALL',
                data: {
                    id: appId,
                    name: appName,
                    icon: appIcon,
                    path: `apps/${appId}/app.html`
                }
            }, '*');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
            // DONT ACTUAL: showNotification(`Custom app "${appName}" installed successfully! It should now appear in XFinder.`, 'success');
            notify('Marketplace', `Custom app "${appName}" installed successfully! It should now appear in XFinder.`);
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('customAppId').value = '';
            document.getElementById('customAppName').value = '';
            document.getElementById('customAppIcon').value = '';
            document.getElementById('installButton').disabled = true;
            
            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
            setTimeout(() => {
                showTab('installed');
            }, 2000);
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function installApp(appId) {
            if (!installedApps.includes(appId)) {
                installedApps.push(appId);
                saveInstalledApps();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                if (currentTab === 'installed') {
                    renderApps('installed');
                } else {
                    renderApps('available');
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –º–µ–Ω—é –û–°
                addAppToOS(appId);
                notify('Marketplace', `Installed app: ${appId}`);
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function uninstallApp(appId) {
            const index = installedApps.indexOf(appId);
            if (index > -1) {
                const appName = getAppName(appId);
                installedApps.splice(index, 1);
                saveInstalledApps();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                if (currentTab === 'installed') {
                    renderApps('installed');
                } else {
                    renderApps('available');
                }
                
                // –£–¥–∞–ª—è–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –º–µ–Ω—é –û–°
                removeAppFromOS(appId);
                notify('Marketplace', `Uninstalled app: ${appId}`);
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ ID
        function getAppName(appId) {
            const app = availableApps.find(a => a.id === appId);
            return app ? app.name : 'App';
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
        function saveInstalledApps() {
            localStorage.setItem('batchos_installed_apps', JSON.stringify(installedApps));
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –û–°
        function addAppToOS(appId) {
            const app = availableApps.find(a => a.id === appId);
            if (app) {
                window.parent.postMessage({
                    type: 'BATCHOS_API',
                    action: 'BATCHOS_APP_INSTALL',
                    data: {
                        id: app.id,
                        name: app.name,
                        icon: app.icon,
                        path: `apps/${app.id}/app.html`
                    }
                }, '*');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ –û–°
        function removeAppFromOS(appId) {
            window.parent.postMessage({
                type: 'BATCHOS_API',
                action: 'BATCHOS_APP_UNINSTALL',
                data: { id: appId }
            }, '*');
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function closeApp() {
            window.parent.postMessage({
                type: 'BATCHOS_API',
                action: 'CLOSE_WINDOW',
                data: { windowId: getWindowId() }
            }, '*');
        }

        function getWindowId() {
            const iframe = window.frameElement;
            return iframe ? iframe.closest('.window')?.id : null;
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∞–≤–∏—à
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeApp();
            }
            
            // Ctrl+Enter –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            if (e.ctrlKey && e.key === 'Enter' && currentTab === 'custom') {
                const installButton = document.getElementById('installButton');
                if (!installButton.disabled) {
                    installCustomApp();
                }
            }
        });
        /////////////////////CURSOR JS CODE/////////////////////////////
        const cursor = document.querySelector('.custom-cursor');
        
        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
        });

        document.addEventListener('mouseout', (e) => {
            if (!e.relatedTarget) {
                cursor.style.opacity = '0';
            }
        });

        document.addEventListener('mouseover', () => {
            cursor.style.opacity = '1';
        });
        //////////////////////DONT DELETE//////////////////////////////
    </script>
</body>
</html>